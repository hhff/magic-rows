(function(a,b,c){"use strict";b.fn.magicRows=function(a){this.addClass("loading");if(this.length>1){this.each(function(){b(this).magicRows(a)});return this}var c=[];var d=[];var e=b.extend({max_height:225,margin:6},a);this.init=function(){var a=b(this).find("img");a.each(function(){var a=b(this);var d={aspect_ratio:a.width()/a.height(),height:a.height(),index:a.parent().index(),width:a.width()};c.push(d)});this.trigger();this.removeClass("loading");var d=this;return this};this.trigger=function(){var a=this.width();while(c.length>0){var f=c.shift();d.push(f);var g=0;for(var h=0;h<d.length;h++){g+=d[h].aspect_ratio}var i=e.margin*d.length*2-2*e.margin;var j=Math.floor((a-i)/g)-1;if(j<=e.max_height){for(var h=0;h<d.length;h++){var k=d[h].index;b(this).find("a:eq("+k+")").find("img")[0].style.height=j+"px";var l;if(h==0){l=e.margin+"px "+e.margin+"px "+e.margin+"px 0px"}else if(h==d.length-1){l=e.margin+"px 0 "+e.margin+"px "+e.margin+"px"}else{l=e.margin+"px"}b(this).find("a:eq("+k+")").find("img")[0].style.margin=l}d=[]}}if(d.length>0){for(var h=0;h<d.length;h++){var k=d[h].index;if(d.length>1)b(this).find("a:eq("+k+")").find("img")[0].style.height=j+"px";var l;if(h==0){l=e.margin+"px "+e.margin+"px "+e.margin+"px 0px"}else if(h==d.length-1){l=e.margin+"px 0 "+e.margin+"px "+e.margin+"px"}else{l=e.margin+"px"}b(this).find("a:eq("+k+")").find("img")[0].style.margin=l}}return this};return this.init()}})(window,jQuery)